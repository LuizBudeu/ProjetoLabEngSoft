{% load static %}

<!DOCTYPE html>
<html lang="en">

  <style>
    #table-wrapper {
      position:relative;
    }
    #table-scroll {
      height:450px;
      overflow:auto;  
      margin-top:20px;
    }
    #table-wrapper table {
      width:100%;
    }
  </style>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Atualização de estado</title>
    <link rel="stylesheet" href="{% static 'projeto/home.css'%}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  </head>
  <body>

    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="{% url 'monitoramento' %}"
              >Voltar <span class="sr-only">(current)</span></a
            >
          </li>
        </ul>
      </div>
    </nav>

    <h2>Atualização de estado</h2>
      <form method="get">
        {{ voos_filter.form.as_p }}
        <input type="submit" value="Selecionar voo" />
      </form>
    
      {% if voos_qs|length == 1 %}
      {% for voo in voos_qs %}
      <form method="POST">
        {% csrf_token %}
        <div class="form-group col-md-3"> <!--TODO: Validar data de envio e status no backend-->
          {% if voo.status == "taxiando" %}
            <label for="partida_real">Partida real</label>
              <input
                name="partida_real"
                type="datetime-local"
                class="form-control"
                placeholder="Partida real"
              />
            <h4 style="color:rgb(255, 56, 56);">{{error_msg}}</h4>
          {% endif %}
          {% if voo.status == "aterrissado" %}
            <label for="chegada_real">Chegada real</label>
              <input
                name="chegada_real"
                type="datetime-local"
                class="form-control"
                placeholder="Chegada real"
              />
            <h4 style="color:rgb(255, 56, 56);">{{error_msg}}</h4>
          {% endif %}
        </div>
        {% if voo.status == "aterrissado" or voo.status == "taxiando" %}
        <button type="submit" class="btn btn-secondary">Atualizar</button>
        {% endif %}
      </form>
      <form method="POST">
        {% csrf_token %}
        <select class="form-select form-select-lg mb-3" aria-label=".form-select-lg example" name="status">
          <option selected>{{voo.status}}</option>
          {% if voo.status == null %}
          <option value="cancelado">cancelado</option>
          <option value="embarcando">embarcando</option>
          {% elif  voo.status == "embarcando" %}
          <option value="programado">programado</option>
          {% elif  voo.status == "programado" %}
          <option value="taxiando">taxiando</option>
          {% elif  voo.status == "taxiando" %}
          <option value="pronto">pronto</option>
          {% elif  voo.status == "pronto" %}
          <option value="autorizado">autorizado</option>
          {% elif  voo.status == "autorizado" %}
          <option value="em voo">em voo</option>
          {% elif  voo.status == "em voo" %}
          <option value="aterrissado">aterrissado</option>
          {% endif %}
        </select>
        <button type="submit" class="btn btn-secondary">Atualizar</button>
      </form> 
      {% endfor %}
      {% endif %}
  </body>
</html>
